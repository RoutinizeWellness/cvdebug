await writeToFileWith};("src/pages/Dashboard.tsx", (content) => {
  const lines = content.split('\n');
  let newLines = [...lines];

  // Find the Dashboard component function start
  const dashboardFunctionIndex = newLines.findIndex(line => line.includes('export default function Dashboard() {'));
  if (dashboardFunctionIndex !== -1) {
    // Insert console.log at the beginning of the Dashboard component's render
    let insertionPoint = dashboardFunctionIndex + 1;
    newLines.splice(insertionPoint, 0,
      `  console.log("Dashboard Render - isLoading:", isLoading, "isAuthenticated:", isAuthenticated, "currentUser:", currentUser);`
    );

    // Find the useEffect for storeUser
    const storeUserEffectIndex = newLines.findIndex(line => line.includes('useEffect(() => {'));
    if (storeUserEffectIndex !== -1) {
      let storeUserEffectEnd = -1;
      let braceCount = 0;
      for (let i = storeUserEffectIndex; i < newLines.length; i++) {
        if (newLines[i].includes('useEffect(() => {')) braceCount++;
        if (newLines[i].includes('}, [isAuthenticated, storeUser]);')) {
          braceCount--;
          if (braceCount === 0) {
            storeUserEffectEnd = i;
            break;
          }
        }
      }

      if (storeUserEffectEnd !== -1) {
        // Replace existing storeUser useEffect with logging
        newLines.splice(storeUserEffectIndex, storeUserEffectEnd - storeUserEffectIndex + 1,
          `  useEffect(() => {`,
          `    console.log("Dashboard useEffect: isAuthenticated for storeUser changed to", isAuthenticated);`,
          `    if (isAuthenticated) {`,
          `      storeUser().then(() => {`,
          `        console.log("storeUser successful");`,
          `      }).catch(error => {`,
          `        console.error("storeUser failed:", error);`,
          `      });`,
          `    }`,
          `  }, [isAuthenticated, storeUser]);`
        );
      }
    }
  }

  return newLines.join('\n');
});
